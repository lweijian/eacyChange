{"version":3,"sources":["uni-app:///pages/blackboard/blackboard.vue","webpack:///E:/Front-end/uni-app/challenge-cup/pages/blackboard/blackboard.vue?df05","uni-app:///main.js","webpack:///E:/Front-end/uni-app/challenge-cup/pages/blackboard/blackboard.vue?75ab","webpack:///E:/Front-end/uni-app/challenge-cup/pages/blackboard/blackboard.vue?c56b","webpack:///E:/Front-end/uni-app/challenge-cup/pages/blackboard/blackboard.vue?8f2d","webpack:///E:/Front-end/uni-app/challenge-cup/pages/blackboard/blackboard.vue?4608"],"names":["createPage","Page","renderjs","component","options","__file","components","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped"],"mappings":";;;;0IAgBA,4C,qbAGA,CACA,YAEA,UACA,cAEA,KANA,WAOA,OACA,kBACA,aACA,cACA,SACA,SACA,eACA,uBACA,SACA,kBACA,UACA,WACA,kDACA,0DACA,UACA,aACA,CACA,WACA,mDACA,2DACA,UACA,cACA,CACA,WACA,gDACA,wDACA,UACA,WACA,CACA,WACA,kDACA,0DACA,UACA,aACA,CACA,WACA,qDACA,6DACA,UACA,YACA,CACA,WACA,iDACA,yDACA,UACA,kBACA,CACA,WACA,mDACA,2DACA,UACA,oBACA,CACA,WACA,uDACA,+DACA,UACA,YACA,CACA,WACA,yDACA,iEACA,UACA,cACA,CACA,WACA,kDACA,0DACA,UACA,cAEA,YACA,WACA,YACA,kBACA,cACA,oBACA,kBACA,sBAGA,OAxFA,WAyFA,qDACA,iBACA,uCAEA,SACA,oBADA,WAEA,cACA,sBAGA,oBANA,SAMA,IACA,8CACA,uBACA,kCACA,YACA,iBACA,gBAGA,iBACA,uBACA,mBACA,yBACA,gBACA,0BACA,sCAEA,sBAvBA,SAuBA,GACA,kBACA,4BACA,kCAEA,mBA5BA,SA4BA,GACA,WACA,yBACA,UACA,YACA,sBACA,MACA,aACA,0CACA,uBACA,MACA,UACA,+CACA,uBACA,iBACA,uBACA,mBACA,yBACA,gBACA,MACA,YACA,yCACA,MACA,WACA,wBACA,sBACA,qBACA,4CAEA,0BACA,wBACA,qBACA,8CACA,2BAEA,kBACA,oDAMA,MACA,iBACA,uBACA,iBACA,mBACA,yBACA,gBACA,uBACA,+CAEA,MACA,mBACA,uBACA,iBACA,mBACA,yBACA,gBACA,uBACA,+CACA,MACA,WACA,uBACA,iBACA,mBACA,yBACA,gBACA,uBACA,+CACA,MACA,aACA,uBACA,iBACA,mBACA,yBACA,gBACA,uBACA,+CACA,MACA,QACA,MAEA,sCAGA,oCACA,YACA,QACA,iBAIA,eAzHA,WA0HA,iBACA,uCAEA,UA7HA,WA8HA,qCACA,+CACA,+CAEA,WAlIA,SAkIA,GACA,aACA,8CACA,cACA,8CACA,oBACA,oDACA,sBACA,sDACA,iBACA,gDAEA,sBACA,iBACA,oBAGA,UAnJA,SAmJA,GACA,aACA,cACA,iDACA,eACA,cACA,gDACA,oBACA,sDACA,sBACA,wDACA,iBACA,kDAEA,sBACA,iBACA,qBAIA,SAvKA,SAuKA,GAEA,cACA,mBACA,gBACA,cACA,8DACA,oBACA,oEACA,sBACA,sEACA,iBACA,iEAGA,gBAtLA,SAsLA,KACA,cACA,6BACA,cACA,eAEA,UA5LA,SA4LA,KACA,cACA,6BACA,cACA,eAEA,kBAlMA,SAkMA,KACA,cACA,6BACA,cACA,eAEA,YAxMA,SAwMA,KACA,cACA,6BACA,cACA,eAKA,SAjNA,SAiNA,OACA,gDACA,4CACA,mDACA,iDACA,wBACA,cAOA,eA9NA,SA8NA,OACA,SACA,KACA,KACA,KAGA,iCACA,iCAEA,iCACA,iCAEA,QACA,QAGA,QACA,QAEA,gDACA,4CACA,mDACA,mDACA,0BACA,aAEA,qBACA,cACA,cACA,kBACA,mBACA,WAEA,4BAEA,oBAlQA,YAmQA,iEAGA,4CACA,4GACA,gGACA,eAEA,sBA3QA,SA2QA,SACA,QAGA,kBACA,UACA,qBAEA,MACA,MAEA,MACA,MAEA,OACA,qBACA,KACA,UAfA,UAuBA,WApSA,SAoSA,OACA,SACA,KACA,KACA,KACA,KAEA,iCACA,iCAEA,iCACA,iCAEA,QACA,QAGA,QACA,QAEA,gBACA,gBAEA,cACA,UACA,uBAIA,4CACA,iDACA,wBAEA,cAMA,iBA3UA,SA2UA,OACA,SACA,KACA,KAEA,iCACA,iCAEA,iCACA,iCAEA,gBACA,gBAEA,cACA,UACA,uBAIA,4CAGA,0BAEA,6BACA,6DACA,4CACA,wBAEA,cAKA,wBACA,cACA,6BACA,cACA,cACA,iDACA,wBAGA,2BACA,iDACA,6BACA,0BACA,cACA,eAGA,mBACA,6BACA,eAGA,sCACA,mCACA,mDAEA,0BAEA,iCACA,SACA,YACA,QAIA,uHACA,oCACA,yBACA,U;;;;2DCpgBA,+oCAAimC,eAAG,G;;;;;;;;wECApmC,qBACA,sBACA,mD,mDACAA,EAAWC,a;;;;2DCHX,sRACIC,EADJ,qJASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,kCACZ,aAAAF,E;;;;2GCvBf,8gC;;;;2GCAA,IAAIG,EAAJ,0LACA,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G;;;;2DCRvB,+pBAAwmB,eAAG,I","file":"pages/blackboard/blackboard.js","sourcesContent":["<template>\r\n\t<view class=\"board-container\">\r\n\t\t\r\n\t\t<Toolbar :penColor=\"currentColor\" @penWidthChange=\"penWidthChangeHandler\" @toolItemTap=\"toolItemTapHandler\" :toolArr=\"toolArr\"></Toolbar>\r\n\t\t<view class=\"board\" :class=\"{'board-out': colorPanelShow}\">\r\n\t\t\t<canvas class=\"board-canvas\" canvas-id=\"drawCanvas\" disable-scroll=\"true\"\r\n\t\t\t @touchstart=\"touchStart\" @touchmove=\"touchMove\" @touchend=\"touchEnd\"></canvas>\r\n\t\t</view>\r\n\t\t<ColorPanel @colorPickTap=\"colorPickTapHandler\" :colorPanelShow=\"colorPanelShow\"></ColorPanel>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\r\n\timport Toolbar from '../../components/toolbar/toolbar.vue'\r\n\timport ColorPanel from '../../components/colorPanel/color-panel.vue'\r\n\timport {\r\n\t\tcustomPrint\r\n\t} from '../../common/util/util.js'\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\r\n\t\t\tToolbar,\r\n\t\t\tColorPanel\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcolorPanelShow: false,\r\n\t\t\t\tdrawInfos: [],\r\n\t\t\t\tcurDrawArr: [],\r\n\t\t\t\tstartX: 0,\r\n\t\t\t\tstartY: 0,\r\n\t\t\t\tdrawContext: {},\r\n\t\t\t\tcurrentColor: '#E0DFED',\r\n\t\t\t\tbegin: false,\r\n\t\t\t\tbgColor: '#202D1C',\r\n\t\t\t\ttoolArr: [{\r\n\t\t\t\t\ttitle: '清空',\r\n\t\t\t\t\ticon: '../../static/img/drawCanvas/tool_clear.png',\r\n\t\t\t\t\tselectIcon: '../../static/img/drawCanvas/tool_clear_s.png',\r\n\t\t\t\t\tselect: false,\r\n\t\t\t\t\turl: 'clear'\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: '橡皮',\r\n\t\t\t\t\ticon: '../../static/img/drawCanvas/tool_eraser.png',\r\n\t\t\t\t\tselectIcon: '../../static/img/drawCanvas/tool_eraser_s.png',\r\n\t\t\t\t\tselect: false,\r\n\t\t\t\t\turl: 'eraser'\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: '画笔',\r\n\t\t\t\t\ticon: '../../static/img/drawCanvas/tool_pen.png',\r\n\t\t\t\t\tselectIcon: '../../static/img/drawCanvas/tool_pen_s.png',\r\n\t\t\t\t\tselect: true,\r\n\t\t\t\t\turl: 'pen'\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: '颜色',\r\n\t\t\t\t\ticon: '../../static/img/drawCanvas/tool_color.png',\r\n\t\t\t\t\tselectIcon: '../../static/img/drawCanvas/tool_color_s.png',\r\n\t\t\t\t\tselect: false,\r\n\t\t\t\t\turl: 'color'\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: '保存',\r\n\t\t\t\t\ticon: '../../static/img/drawCanvas/tool_download.png',\r\n\t\t\t\t\tselectIcon: '../../static/img/drawCanvas/tool_download_s.png',\r\n\t\t\t\t\tselect: false,\r\n\t\t\t\t\turl: 'save'\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: '矩形',\r\n\t\t\t\t\ticon: '../../static/img/drawCanvas/tool_rect.png',\r\n\t\t\t\t\tselectIcon: '../../static/img/drawCanvas/tool_rect_s.png',\r\n\t\t\t\t\tselect: false,\r\n\t\t\t\t\turl: 'hollowRect'\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: '圆形',\r\n\t\t\t\t\ticon: '../../static/img/drawCanvas/tool_circle.png',\r\n\t\t\t\t\tselectIcon: '../../static/img/drawCanvas/tool_circle_s.png',\r\n\t\t\t\t\tselect: false,\r\n\t\t\t\t\turl: 'hollowCircle'\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: '矩形',\r\n\t\t\t\t\ticon: '../../static/img/drawCanvas/tool_rect_solid.png',\r\n\t\t\t\t\tselectIcon: '../../static/img/drawCanvas/tool_rect_solid_s.png',\r\n\t\t\t\t\tselect: false,\r\n\t\t\t\t\turl: 'rect'\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: '圆形',\r\n\t\t\t\t\ticon: '../../static/img/drawCanvas/tool_circle_solid.png',\r\n\t\t\t\t\tselectIcon: '../../static/img/drawCanvas/tool_circle_solid_s.png',\r\n\t\t\t\t\tselect: false,\r\n\t\t\t\t\turl: 'circle'\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: '分享',\r\n\t\t\t\t\ticon: '../../static/img/drawCanvas/tool_share.png',\r\n\t\t\t\t\tselectIcon: '../../static/img/drawCanvas/tool_share_s.png',\r\n\t\t\t\t\tselect: false,\r\n\t\t\t\t\turl: 'share'\r\n\t\t\t\t}],\r\n\t\t\t\tlineWidth: 6,\r\n\t\t\t\tpenMode: true,\r\n\t\t\t\trectMode: false,\r\n\t\t\t\thollowRectMode: false,\r\n\t\t\t\tcircleMode: false,\r\n\t\t\t\thollowCircleMode: false,\r\n\t\t\t\tlastHollowRect: {},\r\n\t\t\t\tlastHollowCircle: {}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tthis.drawContext = uni.createCanvasContext('drawCanvas');\r\n\t\t\tthis.initBoard();\r\n\t\t\tthis.fillBackground(this.drawContext);\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tnavbarBtnTapHandler() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '../mine/mine'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcolorPickTapHandler(obj) {\r\n\t\t\t\tcustomPrint('我点击的颜色:' + JSON.stringify(obj));\r\n\t\t\t\tthis.colorPanelShow = false;\r\n\t\t\t\tthis.toolArr.forEach(item => {\r\n\t\t\t\t\titem.select = false;\r\n\t\t\t\t\tif (item.title === '画笔') {\r\n\t\t\t\t\t\titem.select = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tthis.rectMode = false;\r\n\t\t\t\tthis.hollowRectMode = false;\r\n\t\t\t\tthis.circleMode = false;\r\n\t\t\t\tthis.hollowCircleMode = false;\r\n\t\t\t\tthis.penMode = true;\r\n\t\t\t\tthis.currentColor = obj.color;\r\n\t\t\t\tthis.drawContext.strokeStyle = obj.color;\r\n\t\t\t},\r\n\t\t\tpenWidthChangeHandler(width) {\r\n\t\t\t\tthis.lineWidth = width;\r\n\t\t\t\tcustomPrint('画笔宽度:' + width);\r\n\t\t\t\tthis.drawContext.setLineWidth(width);\r\n\t\t\t},\r\n\t\t\ttoolItemTapHandler(index) {\r\n\t\t\t\tconst that = this;\r\n\t\t\t\tlet url = this.toolArr[index]['url'];\r\n\t\t\t\tswitch (url) {\r\n\t\t\t\t\tcase 'clear':\r\n\t\t\t\t\t\tthis.clearDrawBoard();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'eraser':\r\n\t\t\t\t\t\tthis.drawContext.strokeStyle = this.bgColor;\r\n\t\t\t\t\t\tthis.colorPanelShow = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'pen':\r\n\t\t\t\t\t\tthis.drawContext.strokeStyle = this.currentColor;\r\n\t\t\t\t\t\tthis.colorPanelShow = false;\r\n\t\t\t\t\t\tthis.rectMode = false;\r\n\t\t\t\t\t\tthis.hollowRectMode = false;\r\n\t\t\t\t\t\tthis.circleMode = false;\r\n\t\t\t\t\t\tthis.hollowCircleMode = false;\r\n\t\t\t\t\t\tthis.penMode = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'color':\r\n\t\t\t\t\t\tthis.colorPanelShow = !this.colorPanelShow;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'save':\r\n\t\t\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t\t\tcanvasId: 'drawCanvas',\r\n\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\tcustomPrint('回调参数:' + JSON.stringify(res));\r\n\t\t\t\t\t\t\t\t// 在H5平台下，tempFilePath 为 base64\r\n\t\t\t\t\t\t\t\tuni.saveImageToPhotosAlbum({\r\n\t\t\t\t\t\t\t\t\tfilePath: res.tempFilePath,\r\n\t\t\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\t\t\tcustomPrint('成功回调参数:' + JSON.stringify(res));\r\n\t\t\t\t\t\t\t\t\t\tthat.$api.msgSuccess('保存成功');\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tfail: function(res) {\r\n\t\t\t\t\t\t\t\t\t\tcustomPrint('失败回调参数:' + JSON.stringify(res));\r\n\t\t\t\t\t\t\t\t\t\t// that.$api.msgSuccess('保存成功');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'hollowRect':\r\n\t\t\t\t\t\tthis.hollowRectMode = true;\r\n\t\t\t\t\t\tthis.rectMode = false;\r\n\t\t\t\t\t\tthis.circleMode = false;\r\n\t\t\t\t\t\tthis.hollowCircleMode = false;\r\n\t\t\t\t\t\tthis.penMode = false;\r\n\t\t\t\t\t\tthis.colorPanelShow = false;\r\n\t\t\t\t\t\tthis.drawContext.strokeStyle = this.currentColor;\r\n\t\t\t\t\t\t// this.drawContext.restore();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'hollowCircle':\r\n\t\t\t\t\t\tthis.hollowRectMode = false;\r\n\t\t\t\t\t\tthis.rectMode = false;\r\n\t\t\t\t\t\tthis.circleMode = false;\r\n\t\t\t\t\t\tthis.hollowCircleMode = true;\r\n\t\t\t\t\t\tthis.penMode = false;\r\n\t\t\t\t\t\tthis.colorPanelShow = false;\r\n\t\t\t\t\t\tthis.drawContext.strokeStyle = this.currentColor;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'rect':\r\n\t\t\t\t\t\tthis.hollowRectMode = false;\r\n\t\t\t\t\t\tthis.rectMode = true;\r\n\t\t\t\t\t\tthis.circleMode = false;\r\n\t\t\t\t\t\tthis.hollowCircleMode = false;\r\n\t\t\t\t\t\tthis.penMode = false;\r\n\t\t\t\t\t\tthis.colorPanelShow = false;\r\n\t\t\t\t\t\tthis.drawContext.strokeStyle = this.currentColor;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'circle':\r\n\t\t\t\t\t\tthis.hollowRectMode = false;\r\n\t\t\t\t\t\tthis.rectMode = false;\r\n\t\t\t\t\t\tthis.circleMode = true;\r\n\t\t\t\t\t\tthis.hollowCircleMode = false;\r\n\t\t\t\t\t\tthis.penMode = false;\r\n\t\t\t\t\t\tthis.colorPanelShow = false;\r\n\t\t\t\t\t\tthis.drawContext.strokeStyle = this.currentColor;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (url === 'clear' || url === 'save' || url === 'share') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.toolArr.forEach((item, indexPath) => {\r\n\t\t\t\t\titem.select = false;\r\n\t\t\t\t\tif (indexPath === index) {\r\n\t\t\t\t\t\titem.select = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tclearDrawBoard() {\r\n\t\t\t\tthis.initBoard();\r\n\t\t\t\tthis.fillBackground(this.drawContext);\r\n\t\t\t},\r\n\t\t\tinitBoard() {\r\n\t\t\t\tthis.drawContext.setLineCap('round') // 让线条圆润\r\n\t\t\t\tthis.drawContext.strokeStyle = this.currentColor;\r\n\t\t\t\tthis.drawContext.setLineWidth(this.lineWidth);\r\n\t\t\t},\r\n\t\t\ttouchStart(e) {\r\n\t\t\t\tif (this.penMode) {\r\n\t\t\t\t\tthis.lineBegin(e.touches[0].x, e.touches[0].y)\r\n\t\t\t\t} else if (this.rectMode) {\r\n\t\t\t\t\tthis.rectBegin(e.touches[0].x, e.touches[0].y)\r\n\t\t\t\t} else if (this.hollowRectMode) {\r\n\t\t\t\t\tthis.hollowRectBegin(e.touches[0].x, e.touches[0].y)\r\n\t\t\t\t} else if (this.hollowCircleMode) {\r\n\t\t\t\t\tthis.hollowCircleBegin(e.touches[0].x, e.touches[0].y)\r\n\t\t\t\t} else if (this.circleMode) {\r\n\t\t\t\t\tthis.circleBegin(e.touches[0].x, e.touches[0].y)\r\n\t\t\t\t}\r\n\t\t\t\tthis.curDrawArr.push({\r\n\t\t\t\t\tx: e.touches[0].x,\r\n\t\t\t\t\ty: e.touches[0].y\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\ttouchMove(e) {\r\n\t\t\t\tif (this.begin) {\r\n\t\t\t\t\tif (this.penMode) {\r\n\t\t\t\t\t\tthis.lineAddPoint(e.touches[0].x, e.touches[0].y);\r\n\t\t\t\t\t\tthis.draw(true);\r\n\t\t\t\t\t} else if (this.rectMode) {\r\n\t\t\t\t\t\tthis.drawRect(e.touches[0].x, e.touches[0].y, true);\r\n\t\t\t\t\t} else if (this.hollowRectMode) {\r\n\t\t\t\t\t\tthis.drawHollowRect(e.touches[0].x, e.touches[0].y, true);\r\n\t\t\t\t\t} else if (this.hollowCircleMode) {\r\n\t\t\t\t\t\tthis.drawHollowCircle(e.touches[0].x, e.touches[0].y, true);\r\n\t\t\t\t\t} else if (this.circleMode) {\r\n\t\t\t\t\t\tthis.drawCircle(e.touches[0].x, e.touches[0].y, true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.curDrawArr.push({\r\n\t\t\t\t\t\tx: e.touches[0].x,\r\n\t\t\t\t\t\ty: e.touches[0].y\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttouchEnd(e) {\r\n\t\t\t\t// console.log('结束的坐标x:' + e.changedTouches[0].x + '结束的坐标y:' + e.changedTouches[0].y );\r\n\t\t\t\tif (this.penMode) {\r\n\t\t\t\t\tthis.curDrawArr = [];\r\n\t\t\t\t\tthis.lineEnd();\r\n\t\t\t\t} else if (this.rectMode) {\r\n\t\t\t\t\tthis.drawRect(e.changedTouches[0].x, e.changedTouches[0].y, true);\r\n\t\t\t\t} else if (this.hollowRectMode) {\r\n\t\t\t\t\tthis.drawHollowRect(e.changedTouches[0].x, e.changedTouches[0].y, true);\r\n\t\t\t\t} else if (this.hollowCircleMode) {\r\n\t\t\t\t\tthis.drawHollowCircle(e.changedTouches[0].x, e.changedTouches[0].y, true);\r\n\t\t\t\t} else if (this.circleMode) {\r\n\t\t\t\t\tthis.drawCircle(e.changedTouches[0].x, e.changedTouches[0].y, true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thollowRectBegin(x, y) {\r\n\t\t\t\tthis.begin = true;\r\n\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t},\r\n\t\t\trectBegin(x, y) {\r\n\t\t\t\tthis.begin = true;\r\n\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t},\r\n\t\t\thollowCircleBegin(x, y) {\r\n\t\t\t\tthis.begin = true;\r\n\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t},\r\n\t\t\tcircleBegin(x, y) {\r\n\t\t\t\tthis.begin = true;\r\n\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 这里是画实体矩形\r\n\t\t\t */\r\n\t\t\tdrawRect(x, y, isReverse) {\r\n\t\t\t\tlet width = (x - this.startX) ? (x - this.startX) : (this.startX - x);\r\n\t\t\t\tlet height = (y - this.startY) ? (y - this.startY) : (this.startY - y);\r\n\t\t\t\tthis.drawContext.rect(this.startX, this.startY, width, height);\r\n\t\t\t\tthis.drawContext.setFillStyle(this.currentColor);\r\n\t\t\t\tthis.drawContext.fill();\r\n\t\t\t\tthis.draw(isReverse);\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 这里是画空心矩形\r\n\t\t\t * 方法是根据四个坐标点画\r\n\t\t\t * 四条线进行连接\r\n\t\t\t */\r\n\t\t\tdrawHollowRect(x, y, isReverse) {\r\n\t\t\t\tlet pointLT = {};\r\n\t\t\t\tlet pointRB = {};\r\n\t\t\t\tlet pointRT = {};\r\n\t\t\t\tlet pointLB = {};\r\n\t\t\t\tlet center = {};\r\n\r\n\t\t\t\tpointLT.X = (this.startX <= x) ? this.startX : x;\r\n\t\t\t\tpointLT.Y = (this.startY <= y) ? this.startY : y;\r\n\r\n\t\t\t\tpointRB.X = (this.startX >= x) ? this.startX : x;\r\n\t\t\t\tpointRB.Y = (this.startY >= y) ? this.startY : y;\r\n\r\n\t\t\t\tpointRT.X = pointRB.X;\r\n\t\t\t\tpointRT.Y = pointLT.Y;\r\n\r\n\r\n\t\t\t\tpointLB.X = pointLT.X;\r\n\t\t\t\tpointLB.Y = pointRB.Y;\r\n\r\n\t\t\t\tlet width = (x - this.startX) ? (x - this.startX) : (this.startX - x);\r\n\t\t\t\tlet height = (y - this.startY) ? (y - this.startY) : (this.startY - y);\r\n\t\t\t\tthis.drawContext.rect(this.startX, this.startY, width, height);\r\n\t\t\t\tthis.drawContext.setStrokeStyle(this.currentColor);\r\n\t\t\t\tthis.drawContext.stroke();\r\n\t\t\t\tthis.draw(isReverse);\r\n\r\n\t\t\t\tthis.lastHollowRect = {\r\n\t\t\t\t\tx: this.startX,\r\n\t\t\t\t\ty: this.startY,\r\n\t\t\t\t\twidth: Math.abs(width),\r\n\t\t\t\t\theight: Math.abs(height),\r\n\t\t\t\t\tpointLT: pointLT\r\n\t\t\t\t}\r\n\t\t\t\tthis.clearLastHollowRect();\r\n\t\t\t},\r\n\t\t\tclearLastHollowRect() {\r\n\t\t\t\tcustomPrint('上一个矩形对象:' + JSON.stringify(this.lastHollowRect));\r\n\t\t\t\t// this.drawContext.rect(this.lastHollowRect.pointLT.X + this.lineWidth / 2, this.lastHollowRect.pointLT.Y + this\r\n\t\t\t\t// \t.lineWidth / 2, this.lastHollowRect.width - this.lineWidth, this.lastHollowRect.height - this.lineWidth);\r\n\t\t\t\tthis.drawContext.setFillStyle(this.bgColor);\r\n\t\t\t\tthis.drawContext.fillRect(this.lastHollowRect.pointLT.X + this.lineWidth / 2, this.lastHollowRect.pointLT.Y + this\r\n\t\t\t\t.lineWidth / 2, this.lastHollowRect.width - this.lineWidth, this.lastHollowRect.height - this.lineWidth);\r\n\t\t\t\tthis.draw(true);\r\n\t\t\t},\r\n\t\t\tclearLastHollowCircle(x, y, r, cxt) { //(x,y)为要清除的圆的圆心，r为半径，cxt为context\r\n\t\t\t\tvar stepClear = 1; //别忘记这一步  \r\n\t\t\t\tclearArc(x, y, r);\r\n\r\n\t\t\t\tfunction clearArc(x, y, radius) {\r\n\t\t\t\t\tvar calcWidth = radius - stepClear;\r\n\t\t\t\t\tvar calcHeight = Math.sqrt(radius * radius - calcWidth * calcWidth);\r\n\r\n\t\t\t\t\tvar posX = x - calcWidth;\r\n\t\t\t\t\tvar posY = y - calcHeight;\r\n\r\n\t\t\t\t\tvar widthX = 2 * calcWidth;\r\n\t\t\t\t\tvar heightY = 2 * calcHeight;\r\n\r\n\t\t\t\t\tif (stepClear <= radius) {\r\n\t\t\t\t\t\tcxt.clearRect(posX, posY, widthX, heightY);\r\n\t\t\t\t\t\tstepClear += 1;\r\n\t\t\t\t\t\tclearArc(x, y, radius);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 这里是画\r\n\t\t\t * 实心圆\r\n\t\t\t */\r\n\t\t\tdrawCircle(x, y, isReverse) {\r\n\t\t\t\tlet pointLT = {};\r\n\t\t\t\tlet pointRB = {};\r\n\t\t\t\tlet pointRT = {};\r\n\t\t\t\tlet pointLB = {};\r\n\t\t\t\tlet center = {};\r\n\r\n\t\t\t\tpointLT.X = (this.startX <= x) ? this.startX : x;\r\n\t\t\t\tpointLT.Y = (this.startY <= y) ? this.startY : y;\r\n\r\n\t\t\t\tpointRB.X = (this.startX >= x) ? this.startX : x;\r\n\t\t\t\tpointRB.Y = (this.startY >= y) ? this.startY : y;\r\n\r\n\t\t\t\tpointRT.X = pointRB.X;\r\n\t\t\t\tpointRT.Y = pointLT.Y;\r\n\r\n\r\n\t\t\t\tpointLB.X = pointLT.X;\r\n\t\t\t\tpointLB.Y = pointRB.Y;\r\n\r\n\t\t\t\tcenter.X = (pointRB.X + pointLT.X) / 2;\r\n\t\t\t\tcenter.Y = (pointRB.Y + pointLT.Y) / 2;\r\n\r\n\t\t\t\tlet dx = pointRB.X - pointLT.X;\r\n\t\t\t\tlet dy = pointRB.Y - pointLT.Y;\r\n\t\t\t\tlet r = Math.sqrt(dx * dx + dy * dy) / 2;\r\n\r\n\t\t\t\t// console.log('圆心坐标:' + JSON.stringify(center));\r\n\t\t\t\t// console.log('半径:' + JSON.stringify(r));\r\n\t\t\t\tthis.drawContext.arc(center.X, center.Y, r, 0, 2 * Math.PI);\r\n\t\t\t\tthis.drawContext.setFillStyle(this.currentColor);\r\n\t\t\t\tthis.drawContext.fill();\r\n\t\t\t\t// this.drawContext.stroke();\r\n\t\t\t\tthis.draw(isReverse);\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 这里是画\r\n\t\t\t * 空心圆\r\n\t\t\t */\r\n\t\t\tdrawHollowCircle(x, y, isReverse) {\r\n\t\t\t\tlet pointLT = {};\r\n\t\t\t\tlet pointRB = {};\r\n\t\t\t\tlet center = {};\r\n\r\n\t\t\t\tpointLT.X = (this.startX <= x) ? this.startX : x;\r\n\t\t\t\tpointLT.Y = (this.startY <= y) ? this.startY : y;\r\n\r\n\t\t\t\tpointRB.X = (this.startX >= x) ? this.startX : x;\r\n\t\t\t\tpointRB.Y = (this.startY >= y) ? this.startY : y;\r\n\r\n\t\t\t\tcenter.X = (pointRB.X + pointLT.X) / 2;\r\n\t\t\t\tcenter.Y = (pointRB.Y + pointLT.Y) / 2;\r\n\r\n\t\t\t\tlet dx = pointRB.X - pointLT.X;\r\n\t\t\t\tlet dy = pointRB.Y - pointLT.Y;\r\n\t\t\t\tlet r = Math.sqrt(dx * dx + dy * dy) / 2;\r\n\r\n\t\t\t\t// console.log('圆心坐标:' + JSON.stringify(center));\r\n\t\t\t\t// console.log('半径:' + JSON.stringify(r));\r\n\t\t\t\tthis.drawContext.arc(center.X, center.Y, r, 0, 2 * Math.PI);\r\n\t\t\t\t// this.drawContext.setFillStyle(this.currentColor);\r\n\t\t\t\t// this.drawContext.fill();\r\n\t\t\t\tthis.drawContext.stroke();\r\n\t\t\t\t\r\n\t\t\t\tthis.drawContext.beginPath();\r\n\t\t\t\tthis.drawContext.arc(center.X, center.Y, r - this.lineWidth / 2, 0, 2 * Math.PI);\r\n\t\t\t\tthis.drawContext.setFillStyle(this.bgColor);\r\n\t\t\t\tthis.drawContext.fill();\r\n\t\t\t\t\r\n\t\t\t\tthis.draw(isReverse);\r\n\r\n\t\t\t\t// this.clearLastHollowCircle(center.X, center.Y, r - this.lineWidth / 2, this.drawContext);\r\n\t\t\t},\r\n\t\t\t// 开始绘制线条\r\n\t\t\tlineBegin: function(x, y) {\r\n\t\t\t\tthis.begin = true;\r\n\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t\tthis.drawContext.moveTo(this.startX, this.startY)\r\n\t\t\t\tthis.lineAddPoint(x, y);\r\n\t\t\t},\r\n\t\t\t// 绘制线条中间添加点\r\n\t\t\tlineAddPoint: function(x, y) {\r\n\t\t\t\tthis.drawContext.moveTo(this.startX, this.startY)\r\n\t\t\t\tthis.drawContext.lineTo(x, y);\r\n\t\t\t\tthis.drawContext.stroke();\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t},\r\n\t\t\t// 绘制线条结束\r\n\t\t\tlineEnd: function() {\r\n\t\t\t\tthis.drawContext.closePath();\r\n\t\t\t\tthis.begin = false;\r\n\t\t\t},\r\n\t\t\t// canvas上下文设置背景为白色\r\n\t\t\tfillBackground: function(context) {\r\n\t\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\t\tquery.select('.board').boundingClientRect(data => {\r\n\t\t\t\t\t// console.log(\"得到布局位置信息\" + JSON.stringify(data));\r\n\t\t\t\t\tcontext.setFillStyle(this.bgColor);\r\n\t\t\t\t\t// console.log('当前颜色:' + this.bgColor);\r\n\t\t\t\t\tcontext.fillRect(0, 0, data.width, data.height); //TODO context的宽和高待定\r\n\t\t\t\t\tcontext.fill();\r\n\t\t\t\t\tcontext.draw();\r\n\t\t\t\t}).exec();\r\n\t\t\t},\r\n\t\t\t// 绘制canvas\r\n\t\t\t// isReverse: 是否保留之前的像素\r\n\t\t\tdraw: function(isReverse = false, cb) {\r\n\t\t\t\tthis.drawContext.draw(isReverse, () => {\r\n\t\t\t\t\tif (cb && typeof(cb) == \"function\") {\r\n\t\t\t\t\t\tcb();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.board-container {\r\n\t\theight: 100%;\r\n\t\twidth: 100%;\r\n\t\t// position: relative;\r\n\t\t// display: flex;\r\n\t\t// flex-direction: column;\r\n\r\n\t\t.board {\r\n\t\t\tposition: fixed;\r\n\t\t\ttop: 145px;\r\n\t\t\tleft: 0;\r\n\t\t\tbottom: 0;\r\n\t\t\tright: 0;\r\n\t\t\ttransform: translateY(0);\r\n\t\t\tdisplay: block;\r\n\t\t\r\n\t\t\t.board-canvas {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tz-index: 100;\r\n\t\t\t}\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t\t.board-out {\r\n\t\t\ttransform: translateY(100%);\r\n\t\t\tdisplay: none;\r\n\t\t}\r\n\t}\r\n</style>\n","import mod from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./blackboard.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./blackboard.vue?vue&type=style&index=0&lang=scss&\"","import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/blackboard/blackboard.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./blackboard.vue?vue&type=template&id=05778634&\"\nvar renderjs\nimport script from \"./blackboard.vue?vue&type=script&lang=js&\"\nexport * from \"./blackboard.vue?vue&type=script&lang=js&\"\nimport style0 from \"./blackboard.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/blackboard/blackboard.vue\"\nexport default component.exports","export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./blackboard.vue?vue&type=template&id=05778634&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./blackboard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./blackboard.vue?vue&type=script&lang=js&\""],"sourceRoot":""}