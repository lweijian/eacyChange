(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{103:
/*!*************************************************************************************************!*\
  !*** E:/Front-end/uni-app/challenge-cup/pages/login/login.vue?vue&type=style&index=0&lang=css& ***!
  \*************************************************************************************************/
/*! no static exports found */function(e,n,t){"use strict";t.r(n);var o=t(/*! -!../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src??ref--6-oneOf-1-3!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=style&index=0&lang=css& */104),r=t.n(o);for(var i in o)"default"!==i&&function(e){t.d(n,e,(function(){return o[e]}))}(i);n["default"]=r.a},104:
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/Front-end/uni-app/challenge-cup/pages/login/login.vue?vue&type=style&index=0&lang=css& ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,n,t){},92:
/*!***********************************************************************************!*\
  !*** E:/Front-end/uni-app/challenge-cup/main.js?{"page":"pages%2Flogin%2Flogin"} ***!
  \***********************************************************************************/
/*! no static exports found */function(e,n,t){"use strict";(function(e){t(/*! uni-pages */4);o(t(/*! vue */2));var n=o(t(/*! ./pages/login/login.vue */93));function o(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["createPage"])},93:
/*!****************************************************************!*\
  !*** E:/Front-end/uni-app/challenge-cup/pages/login/login.vue ***!
  \****************************************************************/
/*! no static exports found */function(e,n,t){"use strict";t.r(n);var o=t(/*! ./login.vue?vue&type=template&id=b237504c& */94),r=t(/*! ./login.vue?vue&type=script&lang=js& */96);for(var i in r)"default"!==i&&function(e){t.d(n,e,(function(){return r[e]}))}(i);t(/*! ./login.vue?vue&type=style&index=0&lang=css& */103);var a,c=t(/*! ../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */11),s=Object(c["default"])(r["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],a);s.options.__file="pages/login/login.vue",n["default"]=s.exports},94:
/*!***********************************************************************************************!*\
  !*** E:/Front-end/uni-app/challenge-cup/pages/login/login.vue?vue&type=template&id=b237504c& ***!
  \***********************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,n,t){"use strict";t.r(n);var o=t(/*! -!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=template&id=b237504c& */95);t.d(n,"render",(function(){return o["render"]})),t.d(n,"staticRenderFns",(function(){return o["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return o["recyclableRender"]})),t.d(n,"components",(function(){return o["components"]}))},95:
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/Front-end/uni-app/challenge-cup/pages/login/login.vue?vue&type=template&id=b237504c& ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,n,t){"use strict";var o;t.r(n),t.d(n,"render",(function(){return r})),t.d(n,"staticRenderFns",(function(){return a})),t.d(n,"recyclableRender",(function(){return i})),t.d(n,"components",(function(){return o}));try{o={mInput:function(){return t.e(/*! import() | components/m-input/m-input */"components/m-input/m-input").then(t.bind(null,/*! @/components/m-input/m-input.vue */330))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var e=this,n=e.$createElement;e._self._c;e._isMounted||(e.e0=function(n,t){var o=arguments[arguments.length-1].currentTarget.dataset,r=o.eventParams||o["event-params"];t=r.index;e.loginType=t})},i=!1,a=[];r._withStripped=!0},96:
/*!*****************************************************************************************!*\
  !*** E:/Front-end/uni-app/challenge-cup/pages/login/login.vue?vue&type=script&lang=js& ***!
  \*****************************************************************************************/
/*! no static exports found */function(e,n,t){"use strict";t.r(n);var o=t(/*! -!../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=script&lang=js& */97),r=t.n(o);for(var i in o)"default"!==i&&function(e){t.d(n,e,(function(){return o[e]}))}(i);n["default"]=r.a},97:
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/Front-end/uni-app/challenge-cup/pages/login/login.vue?vue&type=script&lang=js& ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,n,t){"use strict";(function(e,o){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=s(t(/*! ./node_modules/@babel/runtime/regenerator */22)),i=t(/*! vuex */13),a=t(/*! @/common/univerify.js */101),c=t(/*! @/common/utils.js */102);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,n){return h(e)||p(e,n)||d(e,n)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,n){if(e){if("string"===typeof e)return f(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?f(e,n):void 0}}function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function p(e,n){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var t=[],o=!0,r=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(o=(a=c.next()).done);o=!0)if(t.push(a.value),n&&t.length===n)break}catch(s){r=!0,i=s}finally{try{o||null==c["return"]||c["return"]()}finally{if(r)throw i}}return t}}function h(e){if(Array.isArray(e))return e}function g(e,n,t,o,r,i,a){try{var c=e[i](a),s=c.value}catch(u){return void t(u)}c.done?n(s):Promise.resolve(s).then(o,r)}function m(e){return function(){var n=this,t=arguments;return new Promise((function(o,r){var i=e.apply(n,t);function a(e){g(i,o,r,a,c,"next",e)}function c(e){g(i,o,r,a,c,"throw",e)}a(void 0)}))}}function y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function v(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?y(Object(t),!0).forEach((function(n){w(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function w(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var b={deviceId:(0,c.getDeviceUUID)(),scene:"login"},S={data:function(){return{platform:e.getSystemInfoSync().platform,loginType:0,loginTypeList:["免密登录","密码登录"],mobile:"",code:"",providerList:[],hasProvider:!1,username:"",password:"",positionTop:0,isDevtools:!1,codeDuration:0,loginBtnLoading:!1,hasAppleLogin:!1,needCaptcha:e.getStorageSync("uni-needCaptcha"),captchaing:!1,captchaBase64:"",captchaText:""}},computed:(0,i.mapState)(["forcedLogin","hasLogin","univerifyErrorMsg","hideUniverify"]),onLoad:function(){this.needCaptcha&&this.captcha("createCaptcha")},methods:v(v({},(0,i.mapMutations)(["login"])),{},{initProvider:function(){var n=this,t=["weixin","qq","sinaweibo","univerify"];e.getProvider({service:"oauth",success:function(e){if(e.provider&&e.provider.length){-1!==e.provider.indexOf("apple")&&(n.hasAppleLogin=!0);for(var o=0;o<e.provider.length;o++){var r=e.provider[o];t.indexOf(r)&&n.providerList.push({value:r,image:"../../static/img/"+r+".png"})}n.hasProvider=!0}},fail:function(e){console.error("获取服务供应商失败："+JSON.stringify(e))}})},initPosition:function(){this.positionTop=e.getSystemInfoSync().windowHeight-100},sendSmsCode:function(){var n=this;this.codeDuration&&e.showModal({content:"请在".concat(this.codeDuration,"秒后重试"),showCancel:!1}),/^1\d{10}$/.test(this.mobile)?o.callFunction({name:"user-center",data:{action:"sendSmsCode",params:{mobile:this.mobile,type:"login"}},success:function(t){0==t.result.code?(e.showModal({content:"验证码发送成功，请注意查收",showCancel:!1}),n.codeDuration=60,n.codeInterVal=setInterval((function(){n.codeDuration--,0===n.codeDuration&&n.codeInterVal&&(clearInterval(n.codeInterVal),n.codeInterVal=null)}),1e3)):e.showModal({content:"验证码发送失败："+t.result.msg,showCancel:!1})},fail:function(n){e.showModal({content:"验证码发送失败",showCancel:!1})}}):e.showModal({content:"手机号码填写错误",showCancel:!1})},loginByPwd:function(){var n=this;return m(r.default.mark((function t(){var i;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(n.username.length<3)){t.next=3;break}return e.showToast({icon:"none",title:"账号最短为 3 个字符"}),t.abrupt("return");case 3:if(!(n.password.length<6)){t.next=6;break}return e.showToast({icon:"none",title:"密码最短为 6 个字符"}),t.abrupt("return");case 6:i=v({username:n.username,password:n.password,captcha:n.captchaText},b),n.loginBtnLoading=!0,o.callFunction({name:"user-center",data:{action:"login",params:i},success:function(t){0==t.result.code?(n.needCaptcha=!1,e.setStorageSync("uni-needCaptcha",n.needCaptcha),e.setStorageSync("uni_id_token",t.result.token),e.setStorageSync("username",t.result.username),e.setStorageSync("login_type","online"),e.setStorageSync("uni_id_has_pwd",!0),n.toHome(n.username)):(e.showModal({content:t.result.message,showCancel:!1}),n.needCaptcha=t.result.needCaptcha,e.setStorageSync("uni-needCaptcha",n.needCaptcha),n.needCaptcha&&n.captcha("createCaptcha"))},fail:function(n){e.showModal({content:JSON.stringify(n),showCancel:!1})},complete:function(){n.loginBtnLoading=!1}});case 9:case"end":return t.stop()}}),t)})))()},loginBySms:function(){var n=this;/^1\d{10}$/.test(this.mobile)?/^\d{6}$/.test(this.code)?o.callFunction({name:"user-center",data:{action:"loginBySms",params:{mobile:this.mobile,code:this.code}},success:function(t){if(console.log("login success",t),0==t.result.code){var o=t.result.username||"新用户";e.setStorageSync("uni_id_token",t.result.token),e.setStorageSync("username",o),e.setStorageSync("login_type","online"),n.toHome(o)}else e.showModal({content:t.result.msg,showCancel:!1}),console.log("登录失败",t)},fail:function(n){e.showModal({content:JSON.stringify(n),showCancel:!1})}}):e.showModal({title:"验证码为6位纯数字",showCancel:!1}):e.showModal({content:"手机号码填写错误",showCancel:!1})},bindLogin:function(){switch(this.loginType){case 0:this.loginBySms();break;case 1:this.loginByPwd();break;default:break}},oauth:function(n){return new Promise((function(n,t){e.login({provider:"weixin",success:function(e){n(e.code)},fail:function(e){console.error("授权登录失败："+JSON.stringify(e)),t(new Error("微信登录失败"))}})}))},getUserInfo:function(n){var t=n.detail;console.log("三方登录只演示登录api能力，暂未关联云端数据"),t.userInfo?this.loginLocal(t.userInfo.nickName):e.showToast({icon:"none",title:"登陆失败"})},loginLocal:function(n){e.setStorageSync("login_type","local"),e.setStorageSync("username",n),this.toHome(n)},toHome:function(n){this.login(n),e.reLaunch({url:"../tabBar/home/home"})},toLogin:function(n){var t=this;"apple"!==n?"weixin"!==n?"univerify"!==n?e.showModal({content:"".concat(n,"登录只演示登录api能力，暂未关联云端数据"),showCancel:!1,complete:function(){console.log("".concat(n,"登录只演示登录api能力，暂未关联云端数据")),e.login({provider:n,success:function(o){e.getUserInfo({provider:n,success:function(e){t.loginLocal(e.userInfo.nickName)},fail:function(){e.showToast({icon:"none",title:"登陆失败"})}})},fail:function(e){console.error("授权登录失败："+JSON.stringify(e))}})}}):(0,a.univerifyLogin)().catch((function(e){"boolean"!==typeof e&&(0,a.univerifyErrorHandler)(e)})):this.loginByWeixin(n):this.loginByApple(n)},loginByWeixin:function(n){var t=this;this.oauth(n).then((function(e){return o.callFunction({name:"user-center",data:{action:"loginByWeixin",params:{code:e}}})})).then((function(n){0===n.result.code&&(e.setStorageSync("uni_id_token",n.result.token),e.setStorageSync("uni_id_token_expired",n.result.tokenExpired),e.setStorageSync("login_type","online"),e.setStorageSync("username","微信用户"),t.toHome("微信用户"))})).catch((function(n){console.error(n),e.showModal({showCancel:!1,content:"微信登录失败，请稍后再试"})}))},loginByApple:function(n){var t=this;return m(r.default.mark((function i(){var a,c,s,l,d,f,p,h,g;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.hasAppleLogin){r.next=3;break}return e.showModal({showCancel:!1,content:"暂无法使用苹果登录，Apple登录集成教程：\nhttps://ask.dcloud.net.cn/article/36651"}),r.abrupt("return");case 3:return a=n,r.next=7,e.login({provider:a});case 7:if(c=r.sent,s=u(c,2),l=s[0],s[1],!l){r.next=14;break}return e.showModal({showCancel:!1,content:"苹果登录失败，请稍后再试"}),r.abrupt("return");case 14:return r.next=16,e.getUserInfo({provider:a});case 16:if(d=r.sent,f=u(d,2),p=f[0],h=f[1],!p){r.next=25;break}return g=p.errMsg,~g.indexOf("uni.login")&&(g="请先完成登录操作"),e.showModal({title:"获取用户信息失败",content:"错误原因"+g,showCancel:!1}),r.abrupt("return");case 25:o.callFunction({name:"user-center",data:{action:"loginByApple",params:h.userInfo},success:function(n){if(console.log("loginByApple success",n),n.success){var o=n.result.username||n.result.nickname;e.setStorageSync("uni_id_token",n.result.token),e.setStorageSync("login_type","online"),t.toHome(o)}else e.showModal({showCancel:!1,content:JSON.stringify(n.message)})},fail:function(n){e.showModal({content:"苹果登录失败: ".concat(JSON.stringify(n)),showCancel:!1})}});case 26:case"end":return r.stop()}}),i)})))()},captcha:function(n,t){var i=this;return m(r.default.mark((function a(){var c,s;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!i.captchaing){r.next=2;break}return r.abrupt("return");case 2:return i.captchaing=!0,r.next=5,o.callFunction({name:"user-center",data:{action:n,params:v(v({},b),t)}});case 5:return c=r.sent,s=c.result,i.captchaing=!1,0===s.code?i.captchaBase64=s.captchaBase64:e.showToast({icon:"none",title:s.message,duration:1e3}),r.abrupt("return",s);case 10:case"end":return r.stop()}}),a)})))()},openAppleLoginDoc:function(){}}),onReady:function(){this.initPosition(),this.initProvider(),this.isDevtools="devtools"===e.getSystemInfoSync().platform}};n.default=S}).call(this,t(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"],t(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js */98)["default"])}},[[92,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/login/login.js.map