(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/penCut/penCut"],{158:
/*!*************************************************************************************!*\
  !*** E:/Front-end/uni-app/challenge-cup/main.js?{"page":"pages%2FpenCut%2FpenCut"} ***!
  \*************************************************************************************/
/*! no static exports found */function(t,n,i){"use strict";(function(t){i(/*! uni-pages */4);a(i(/*! vue */2));var n=a(i(/*! ./pages/penCut/penCut.vue */159));function a(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,i(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["createPage"])},159:
/*!******************************************************************!*\
  !*** E:/Front-end/uni-app/challenge-cup/pages/penCut/penCut.vue ***!
  \******************************************************************/
/*! no static exports found */function(t,n,i){"use strict";i.r(n);var a=i(/*! ./penCut.vue?vue&type=template&id=679525a6& */160),e=i(/*! ./penCut.vue?vue&type=script&lang=js& */162);for(var o in e)"default"!==o&&function(t){i.d(n,t,(function(){return e[t]}))}(o);i(/*! ./penCut.vue?vue&type=style&index=0&lang=css& */165);var s,c=i(/*! ../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */12),r=Object(c["default"])(e["default"],a["render"],a["staticRenderFns"],!1,null,null,null,!1,a["components"],s);r.options.__file="pages/penCut/penCut.vue",n["default"]=r.exports},160:
/*!*************************************************************************************************!*\
  !*** E:/Front-end/uni-app/challenge-cup/pages/penCut/penCut.vue?vue&type=template&id=679525a6& ***!
  \*************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,n,i){"use strict";i.r(n);var a=i(/*! -!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./penCut.vue?vue&type=template&id=679525a6& */161);i.d(n,"render",(function(){return a["render"]})),i.d(n,"staticRenderFns",(function(){return a["staticRenderFns"]})),i.d(n,"recyclableRender",(function(){return a["recyclableRender"]})),i.d(n,"components",(function(){return a["components"]}))},161:
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/Front-end/uni-app/challenge-cup/pages/penCut/penCut.vue?vue&type=template&id=679525a6& ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,n,i){"use strict";var a;i.r(n),i.d(n,"render",(function(){return e})),i.d(n,"staticRenderFns",(function(){return s})),i.d(n,"recyclableRender",(function(){return o})),i.d(n,"components",(function(){return a}));var e=function(){var t=this,n=t.$createElement;t._self._c},o=!1,s=[];e._withStripped=!0},162:
/*!*******************************************************************************************!*\
  !*** E:/Front-end/uni-app/challenge-cup/pages/penCut/penCut.vue?vue&type=script&lang=js& ***!
  \*******************************************************************************************/
/*! no static exports found */function(t,n,i){"use strict";i.r(n);var a=i(/*! -!../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./penCut.vue?vue&type=script&lang=js& */163),e=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(n,t,(function(){return a[t]}))}(o);n["default"]=e.a},163:
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/Front-end/uni-app/challenge-cup/pages/penCut/penCut.vue?vue&type=script&lang=js& ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,n,i){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=o(i(/*! ./node_modules/@babel/runtime/regenerator */23)),e=o(i(/*! ../../static/js/Point.js */164));function o(t){return t&&t.__esModule?t:{default:t}}function s(t,n,i,a,e,o,s){try{var c=t[o](s),r=c.value}catch(h){return void i(h)}c.done?n(r):Promise.resolve(r).then(a,e)}function c(t){return function(){var n=this,i=arguments;return new Promise((function(a,e){var o=t.apply(n,i);function c(t){s(o,a,e,c,r,"next",t)}function r(t){s(o,a,e,c,r,"throw",t)}c(void 0)}))}}var r={data:function(){return{backgroundImageSrc:"",keepBackground:!0,imgCutShowSrc:"",img:{id:"imgCut",width:0,height:0},canvas:{id:"canvas",width:0,height:0,pointList:[],tempPointList:[],roundR:10,roundRr:1,curPointIndex:0,paint:!1,juPull:!1,isClose:!1}}},onReady:function(){var n=this,i=t.createSelectorQuery().in(this);i.select("#".concat(this.canvas.id)).boundingClientRect((function(t){n.img.height=t.height,n.img.width=t.width,n.canvas.height=t.height,n.canvas.width=t.width})).exec()},onLoad:function(t){this.backgroundImageSrc=t.backgroundImageSrc},methods:{drawLine:function(t,n,i,a,e){t.moveTo(n,i),t.lineTo(a,e),t.stroke()},drawArc:function(t,n,i){t.beginPath(),t.arc(n,i,this.canvas.roundRr,360,2*Math.PI,!0),t.closePath(),t.stroke()},drawAllLine:function(t){var n=this.canvas.pointList;if(n.length>1){for(var i=0,a=n.length;i<a;i++)this.drawArc(t,n[i].pointx,n[i].pointy);for(var e=0,o=n.length;e<o-1;e++)this.drawLine(t,n[e].pointx,n[e].pointy,n[e+1].pointx,n[e+1].pointy)}},drawAllMove:function(t,n,i){if(!this.canvas.isClose&&this.canvas.pointList.length>=1){this.clearCanvas(t);for(var a=this.canvas.pointList,e=0;e<this.canvas.pointList.length-1;e++)this.drawLine(t,a[e].pointx,a[e].pointy,a[e+1].pointx,a[e+1].pointy),this.drawArc(t,a[e].pointx,a[e].pointy),e==this.canvas.pointList.length-2&&this.drawArc(t,a[e+1].pointx,a[e+1].pointy);1==a.length&&this.drawArc(t,a[0].pointx,a[0].pointy),this.drawArc(t,n,i),this.drawLine(t,a[this.canvas.pointList.length-1].pointx,a[this.canvas.pointList.length-1].pointy,n,i)}},clearCanvas:function(t){t.clearRect(0,0,this.canvas.width,this.canvas.height)},fillBackColor:function(t){t.setFillStyle("white"),t.fillRect(0,0,this.canvas.width,this.canvas.height),t.globalCompositeOperation="destination-out",t.beginPath();for(var n=0;n<this.canvas.pointList.length;n++)t.lineTo(this.canvas.pointList[n].pointx,this.canvas.pointList[n].pointy);t.closePath(),t.fill(),t.globalCompositeOperation="destination-over"},setOriPoints:function(t,n){this.clearCanvas(t),null!=n&&n.length>0&&(this.canvas.pointList=n.concat(),n.length>1&&n[n.length-1].pointx===n[0].pointx?(this.canvas.isClose=!0,this.fillBackColor(t)):this.drawAllLine(t))},equalStartPoint:function(t,n,i){t.length>2&&Math.abs((n-t[0].pointx)*(n-t[0].pointx))+Math.abs((i-t[0].pointy)*(i-t[0].pointy))<=this.canvas.roundR*this.canvas.roundR?(this.canvas.isClose=!0,t[t.length-1].pointx=t[0].pointx,t[t.length-1].pointy=t[0].pointy):this.canvas.isClose=!1},roundIn:function(t,n,i,a){if(this.canvas.juPull)n[this.canvas.curPointIndex].pointx=i,n[this.canvas.curPointIndex].pointy=a,this.clearCanvas(t),this.canvas.isClose&&this.fillBackColor(t),this.drawAllLine(t);else for(var e=0;e<n.length;e++)if(Math.abs((i-n[e].pointx)*(i-n[e].pointx))+Math.abs((a-n[e].pointy)*(a-n[e].pointy))<=2.5*this.canvas.roundR*this.canvas.roundR)return this.canvas.juPull=!0,this.canvas.curPointIndex=e,n[e].pointx=i,n[e].pointy=a,this.clearCanvas(t),this.canvas.isClose&&this.fillBackColor(t),void this.drawAllLine(t)},movePointArray:function(t){for(var n=t[0].pointx,i=t[0].pointy,a=n,o=i,s=new Array,c=1;c<t.length;c++)t[c].pointx<n&&(n=t[c].pointx),t[c].pointx>a&&(a=t[c].pointx),t[c].pointy<i&&(i=t[c].pointy),t[c].pointy>o&&(o=t[c].pointy);for(var r=0;r<t.length;r++)t[r].pointx-=n,t[r].pointy-=i;return s[0]=new e.default(n,i),s[1]=new e.default(a,o),s},getXAndY:function(t){var n=t.changedTouches[0].x,i=t.changedTouches[0].y;return{x:n,y:i}},touchMoveEvent:function(n){var i=this.getXAndY(n),a=i.x,e=i.y,o=this.canvas.pointList,s=t.createCanvasContext("canvas");this.canvas.paint&&(o.length>0&&this.equalStartPoint(o,o[o.length-1].pointx,o[o.length-1].pointy),this.roundIn(s,o,a,e)),this.drawAllMove(s,a,e),s.draw()},touchStartEvent:function(n){t.createCanvasContext("canvas");this.canvas.paint=!0,this.canvas.tempPointList.length>0&&(this.canvas.pointList.splice(this.canvas.tempPointList[1].pointx,0,new e.default(this.canvas.tempPointList[0].pointx,this.canvas.tempPointList[0].pointy)),this.canvas.tempPointList.length=0)},touchEndEvent:function(n){var i=this.getXAndY(n),a=i.x,o=i.y,s=t.createCanvasContext("canvas"),c=this.canvas.pointList;if(this.canvas.paint=!1,this.canvas.juPull)this.canvas.juPull=!1,this.canvas.curPointIndex=0,this.equalStartPoint(c,c[c.length-1].pointx,c[c.length-1].pointy);else if(this.canvas.isClose)this.fillBackColor(s);else if(c.push(new e.default(a,o)),this.equalStartPoint(c,c[c.length-1].pointx,c[c.length-1].pointy),c.length>1){for(var r=0,h=c.length;r<h;r++)this.drawArc(s,c[r].pointx,c[r].pointy);for(var l=0,u=c.length;l<u-1;l++)this.drawLine(s,c[l].pointx,c[l].pointy,c[l+1].pointx,c[l+1].pointy)}else this.drawArc(s,c[c.length-1].pointx,c[c.length-1].pointy);this.canvas.isClose&&(this.fillBackColor(s),this.drawAllLine(s)),s.draw()},notEmptyObj:function(t){return null!==t&&void 0!==t&&""!==t},saveImageToPhotosAlbum:function(n){t.saveImageToPhotosAlbum({filePath:n,success:function(){console.log("保存成功")},fail:function(t){console.log("保存失败")}})},reDo:function(){var n=t.createCanvasContext("canvas");this.clearCanvas(n),n.draw(),this.canvas.pointList.length=0,this.canvas.isClose=!1},cutImg:function(){var n=t.createCanvasContext("canvas");this.clearCanvas(n),n.draw(),n.setStrokeStyle("#ffffff"),this.fillBackColor(n),this.drawAllLine(n),n.draw()},downLoad:function(){var n=this;return c(a.default.mark((function i(){var e,o,s,c;return a.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e=[],o=[],s=t.createCanvasContext("canvas"),!(n.notEmptyObj(n.canvas.pointList)&&n.canvas.pointList.length>1)){i.next=8;break}o=JSON.parse(JSON.stringify(n.canvas.pointList)),e=n.movePointArray(o),i.next=10;break;case 8:return t.showToast({title:"请先进行抠图操作"}),i.abrupt("return");case 10:for(s.beginPath(),c=0;c<o.length;c++)s.lineTo(o[c].pointx,o[c].pointy);s.lineTo(o[0].pointx,o[0].pointy),s.clip(),n.keepBackground?t.getImageInfo({src:n.backgroundImageSrc,success:function(i){s.drawImage(i.path,-1*e[0].pointx,-1*e[0].pointy,n.img.width,n.img.height),s.draw(!1,(function(){t.canvasToTempFilePath({x:0,y:0,width:n.canvas.width,height:n.canvas.height,destWidth:n.canvas.width,destHeight:n.canvas.width,canvasId:"canvas",success:function(t){console.log(t.tempFilePath),n.imgCutShowSrc=t.tempFilePath,n.saveImageToPhotosAlbum(n.imgCutShowSrc)}})}))}}):t.canvasToTempFilePath({x:0,y:0,width:n.canvas.width,height:n.canvas.height,destWidth:n.canvas.width,destHeight:n.canvas.width,canvasId:"canvas",success:function(t){n.imgCutShowSrc=t.tempFilePath,n.saveImageToPhotosAlbum(n.imgCutShowSrc)}});case 15:case"end":return i.stop()}}),i)})))()}}};n.default=r}).call(this,i(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])},165:
/*!***************************************************************************************************!*\
  !*** E:/Front-end/uni-app/challenge-cup/pages/penCut/penCut.vue?vue&type=style&index=0&lang=css& ***!
  \***************************************************************************************************/
/*! no static exports found */function(t,n,i){"use strict";i.r(n);var a=i(/*! -!../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src??ref--6-oneOf-1-3!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./penCut.vue?vue&type=style&index=0&lang=css& */166),e=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(n,t,(function(){return a[t]}))}(o);n["default"]=e.a},166:
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/Front-end/uni-app/challenge-cup/pages/penCut/penCut.vue?vue&type=style&index=0&lang=css& ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,n,i){}},[[158,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/penCut/penCut.js.map