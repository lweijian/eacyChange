(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/blackboard/blackboard"],{"13d0":function(t,e,o){"use strict";(function(t){o("e2fc");i(o("66fd"));var e=i(o("1428"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},1428:function(t,e,o){"use strict";o.r(e);var i=o("502a"),s=o("c660");for(var r in s)"default"!==r&&function(t){o.d(e,t,(function(){return s[t]}))}(r);o("2f16");var a,n=o("f0c5"),c=Object(n["a"])(s["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=c.exports},"1b15":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o("233b"),s=function(){o.e("components/toolbar/toolbar").then(function(){return resolve(o("c521"))}.bind(null,o)).catch(o.oe)},r=function(){o.e("components/colorPanel/color-panel").then(function(){return resolve(o("26e7"))}.bind(null,o)).catch(o.oe)},a={components:{Toolbar:s,ColorPanel:r},data:function(){return{colorPanelShow:!1,drawInfos:[],curDrawArr:[],startX:0,startY:0,drawContext:{},currentColor:"#E0DFED",begin:!1,bgColor:"#202D1C",toolArr:[{title:"清空",icon:"../../static/img/drawCanvas/tool_clear.png",selectIcon:"../../static/img/drawCanvas/tool_clear_s.png",select:!1,url:"clear"},{title:"橡皮",icon:"../../static/img/drawCanvas/tool_eraser.png",selectIcon:"../../static/img/drawCanvas/tool_eraser_s.png",select:!1,url:"eraser"},{title:"画笔",icon:"../../static/img/drawCanvas/tool_pen.png",selectIcon:"../../static/img/drawCanvas/tool_pen_s.png",select:!0,url:"pen"},{title:"颜色",icon:"../../static/img/drawCanvas/tool_color.png",selectIcon:"../../static/img/drawCanvas/tool_color_s.png",select:!1,url:"color"},{title:"保存",icon:"../../static/img/drawCanvas/tool_download.png",selectIcon:"../../static/img/drawCanvas/tool_download_s.png",select:!1,url:"save"},{title:"矩形",icon:"../../static/img/drawCanvas/tool_rect.png",selectIcon:"../../static/img/drawCanvas/tool_rect_s.png",select:!1,url:"hollowRect"},{title:"圆形",icon:"../../static/img/drawCanvas/tool_circle.png",selectIcon:"../../static/img/drawCanvas/tool_circle_s.png",select:!1,url:"hollowCircle"},{title:"矩形",icon:"../../static/img/drawCanvas/tool_rect_solid.png",selectIcon:"../../static/img/drawCanvas/tool_rect_solid_s.png",select:!1,url:"rect"},{title:"圆形",icon:"../../static/img/drawCanvas/tool_circle_solid.png",selectIcon:"../../static/img/drawCanvas/tool_circle_solid_s.png",select:!1,url:"circle"},{title:"分享",icon:"../../static/img/drawCanvas/tool_share.png",selectIcon:"../../static/img/drawCanvas/tool_share_s.png",select:!1,url:"share"}],lineWidth:6,penMode:!0,rectMode:!1,hollowRectMode:!1,circleMode:!1,hollowCircleMode:!1,lastHollowRect:{},lastHollowCircle:{}}},onLoad:function(){this.drawContext=t.createCanvasContext("drawCanvas"),this.initBoard(),this.fillBackground(this.drawContext)},methods:{navbarBtnTapHandler:function(){t.navigateTo({url:"../mine/mine"})},colorPickTapHandler:function(t){(0,i.customPrint)("我点击的颜色:"+JSON.stringify(t)),this.colorPanelShow=!1,this.toolArr.forEach((function(t){t.select=!1,"画笔"===t.title&&(t.select=!0)})),this.rectMode=!1,this.hollowRectMode=!1,this.circleMode=!1,this.hollowCircleMode=!1,this.penMode=!0,this.currentColor=t.color,this.drawContext.strokeStyle=t.color},penWidthChangeHandler:function(t){this.lineWidth=t,(0,i.customPrint)("画笔宽度:"+t),this.drawContext.setLineWidth(t)},toolItemTapHandler:function(e){var o=this,s=this.toolArr[e]["url"];switch(s){case"clear":this.clearDrawBoard();break;case"eraser":this.drawContext.strokeStyle=this.bgColor,this.colorPanelShow=!1;break;case"pen":this.drawContext.strokeStyle=this.currentColor,this.colorPanelShow=!1,this.rectMode=!1,this.hollowRectMode=!1,this.circleMode=!1,this.hollowCircleMode=!1,this.penMode=!0;break;case"color":this.colorPanelShow=!this.colorPanelShow;break;case"save":t.canvasToTempFilePath({canvasId:"drawCanvas",success:function(e){(0,i.customPrint)("回调参数:"+JSON.stringify(e)),t.saveImageToPhotosAlbum({filePath:e.tempFilePath,success:function(t){(0,i.customPrint)("成功回调参数:"+JSON.stringify(t)),o.$api.msgSuccess("保存成功")},fail:function(t){(0,i.customPrint)("失败回调参数:"+JSON.stringify(t))}})}});break;case"hollowRect":this.hollowRectMode=!0,this.rectMode=!1,this.circleMode=!1,this.hollowCircleMode=!1,this.penMode=!1,this.colorPanelShow=!1,this.drawContext.strokeStyle=this.currentColor;break;case"hollowCircle":this.hollowRectMode=!1,this.rectMode=!1,this.circleMode=!1,this.hollowCircleMode=!0,this.penMode=!1,this.colorPanelShow=!1,this.drawContext.strokeStyle=this.currentColor;break;case"rect":this.hollowRectMode=!1,this.rectMode=!0,this.circleMode=!1,this.hollowCircleMode=!1,this.penMode=!1,this.colorPanelShow=!1,this.drawContext.strokeStyle=this.currentColor;break;case"circle":this.hollowRectMode=!1,this.rectMode=!1,this.circleMode=!0,this.hollowCircleMode=!1,this.penMode=!1,this.colorPanelShow=!1,this.drawContext.strokeStyle=this.currentColor;break;default:break}"clear"!==s&&"save"!==s&&"share"!==s&&this.toolArr.forEach((function(t,o){t.select=!1,o===e&&(t.select=!0)}))},clearDrawBoard:function(){this.initBoard(),this.fillBackground(this.drawContext)},initBoard:function(){this.drawContext.setLineCap("round"),this.drawContext.strokeStyle=this.currentColor,this.drawContext.setLineWidth(this.lineWidth)},touchStart:function(t){this.penMode?this.lineBegin(t.touches[0].x,t.touches[0].y):this.rectMode?this.rectBegin(t.touches[0].x,t.touches[0].y):this.hollowRectMode?this.hollowRectBegin(t.touches[0].x,t.touches[0].y):this.hollowCircleMode?this.hollowCircleBegin(t.touches[0].x,t.touches[0].y):this.circleMode&&this.circleBegin(t.touches[0].x,t.touches[0].y),this.curDrawArr.push({x:t.touches[0].x,y:t.touches[0].y})},touchMove:function(t){this.begin&&(this.penMode?(this.lineAddPoint(t.touches[0].x,t.touches[0].y),this.draw(!0)):this.rectMode?this.drawRect(t.touches[0].x,t.touches[0].y,!0):this.hollowRectMode?this.drawHollowRect(t.touches[0].x,t.touches[0].y,!0):this.hollowCircleMode?this.drawHollowCircle(t.touches[0].x,t.touches[0].y,!0):this.circleMode&&this.drawCircle(t.touches[0].x,t.touches[0].y,!0),this.curDrawArr.push({x:t.touches[0].x,y:t.touches[0].y}))},touchEnd:function(t){this.penMode?(this.curDrawArr=[],this.lineEnd()):this.rectMode?this.drawRect(t.changedTouches[0].x,t.changedTouches[0].y,!0):this.hollowRectMode?this.drawHollowRect(t.changedTouches[0].x,t.changedTouches[0].y,!0):this.hollowCircleMode?this.drawHollowCircle(t.changedTouches[0].x,t.changedTouches[0].y,!0):this.circleMode&&this.drawCircle(t.changedTouches[0].x,t.changedTouches[0].y,!0)},hollowRectBegin:function(t,e){this.begin=!0,this.drawContext.beginPath(),this.startX=t,this.startY=e},rectBegin:function(t,e){this.begin=!0,this.drawContext.beginPath(),this.startX=t,this.startY=e},hollowCircleBegin:function(t,e){this.begin=!0,this.drawContext.beginPath(),this.startX=t,this.startY=e},circleBegin:function(t,e){this.begin=!0,this.drawContext.beginPath(),this.startX=t,this.startY=e},drawRect:function(t,e,o){var i=t-this.startX?t-this.startX:this.startX-t,s=e-this.startY?e-this.startY:this.startY-e;this.drawContext.rect(this.startX,this.startY,i,s),this.drawContext.setFillStyle(this.currentColor),this.drawContext.fill(),this.draw(o)},drawHollowRect:function(t,e,o){var i={},s={},r={},a={};i.X=this.startX<=t?this.startX:t,i.Y=this.startY<=e?this.startY:e,s.X=this.startX>=t?this.startX:t,s.Y=this.startY>=e?this.startY:e,r.X=s.X,r.Y=i.Y,a.X=i.X,a.Y=s.Y;var n=t-this.startX?t-this.startX:this.startX-t,c=e-this.startY?e-this.startY:this.startY-e;this.drawContext.rect(this.startX,this.startY,n,c),this.drawContext.setStrokeStyle(this.currentColor),this.drawContext.stroke(),this.draw(o),this.lastHollowRect={x:this.startX,y:this.startY,width:Math.abs(n),height:Math.abs(c),pointLT:i},this.clearLastHollowRect()},clearLastHollowRect:function(){(0,i.customPrint)("上一个矩形对象:"+JSON.stringify(this.lastHollowRect)),this.drawContext.setFillStyle(this.bgColor),this.drawContext.fillRect(this.lastHollowRect.pointLT.X+this.lineWidth/2,this.lastHollowRect.pointLT.Y+this.lineWidth/2,this.lastHollowRect.width-this.lineWidth,this.lastHollowRect.height-this.lineWidth),this.draw(!0)},clearLastHollowCircle:function(t,e,o,i){var s=1;function r(t,e,o){var a=o-s,n=Math.sqrt(o*o-a*a),c=t-a,l=e-n,h=2*a,d=2*n;s<=o&&(i.clearRect(c,l,h,d),s+=1,r(t,e,o))}r(t,e,o)},drawCircle:function(t,e,o){var i={},s={},r={},a={},n={};i.X=this.startX<=t?this.startX:t,i.Y=this.startY<=e?this.startY:e,s.X=this.startX>=t?this.startX:t,s.Y=this.startY>=e?this.startY:e,r.X=s.X,r.Y=i.Y,a.X=i.X,a.Y=s.Y,n.X=(s.X+i.X)/2,n.Y=(s.Y+i.Y)/2;var c=s.X-i.X,l=s.Y-i.Y,h=Math.sqrt(c*c+l*l)/2;this.drawContext.arc(n.X,n.Y,h,0,2*Math.PI),this.drawContext.setFillStyle(this.currentColor),this.drawContext.fill(),this.draw(o)},drawHollowCircle:function(t,e,o){var i={},s={},r={};i.X=this.startX<=t?this.startX:t,i.Y=this.startY<=e?this.startY:e,s.X=this.startX>=t?this.startX:t,s.Y=this.startY>=e?this.startY:e,r.X=(s.X+i.X)/2,r.Y=(s.Y+i.Y)/2;var a=s.X-i.X,n=s.Y-i.Y,c=Math.sqrt(a*a+n*n)/2;this.drawContext.arc(r.X,r.Y,c,0,2*Math.PI),this.drawContext.stroke(),this.drawContext.beginPath(),this.drawContext.arc(r.X,r.Y,c-this.lineWidth/2,0,2*Math.PI),this.drawContext.setFillStyle(this.bgColor),this.drawContext.fill(),this.draw(o)},lineBegin:function(t,e){this.begin=!0,this.drawContext.beginPath(),this.startX=t,this.startY=e,this.drawContext.moveTo(this.startX,this.startY),this.lineAddPoint(t,e)},lineAddPoint:function(t,e){this.drawContext.moveTo(this.startX,this.startY),this.drawContext.lineTo(t,e),this.drawContext.stroke(),this.startX=t,this.startY=e},lineEnd:function(){this.drawContext.closePath(),this.begin=!1},fillBackground:function(e){var o=this,i=t.createSelectorQuery().in(this);i.select(".board").boundingClientRect((function(t){e.setFillStyle(o.bgColor),e.fillRect(0,0,t.width,t.height),e.fill(),e.draw()})).exec()},draw:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;this.drawContext.draw(t,(function(){e&&"function"==typeof e&&e()}))}}};e.default=a}).call(this,o("543d")["default"])},"2f16":function(t,e,o){"use strict";var i=o("8d3a"),s=o.n(i);s.a},"502a":function(t,e,o){"use strict";var i;o.d(e,"b",(function(){return s})),o.d(e,"c",(function(){return r})),o.d(e,"a",(function(){return i}));var s=function(){var t=this,e=t.$createElement;t._self._c},r=[]},"8d3a":function(t,e,o){},c660:function(t,e,o){"use strict";o.r(e);var i=o("1b15"),s=o.n(i);for(var r in i)"default"!==r&&function(t){o.d(e,t,(function(){return i[t]}))}(r);e["default"]=s.a}},[["13d0","common/runtime","common/vendor"]]]);